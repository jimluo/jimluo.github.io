<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />

    <style>
      :root {
        --accent-color: #05a081;
        --accent-color-light: #82d0c0;
        --accent-overlay-color: #fff;
        --body-bg: #fff;
        --body-color: #000;
        --heading-color: #000;
        --table-bg-even: #f3f3f3;
        --table-border-bottom: #dddddd;
      }
      
    </style>

    <meta name="theme-color" content="#05a081" />

    
      <link rel="icon" href="https:&#x2F;&#x2F;jimluo.github.io&#x2F;processed_images&#x2F;106e1fb7d8c11fe100.png" />
      <link rel="apple-touch-icon" sizes="48x48" href="https:&#x2F;&#x2F;jimluo.github.io&#x2F;processed_images&#x2F;106e1fb7d8c11fe100.png" />
      <link rel="apple-touch-icon" sizes="72x72" href="https:&#x2F;&#x2F;jimluo.github.io&#x2F;processed_images&#x2F;38c5aeca4d24ddfe00.png" />
      <link rel="apple-touch-icon" sizes="96x96" href="https:&#x2F;&#x2F;jimluo.github.io&#x2F;processed_images&#x2F;74cf6cb0a69d143300.png" />
      <link rel="apple-touch-icon" sizes="144x144" href="https:&#x2F;&#x2F;jimluo.github.io&#x2F;processed_images&#x2F;b7f9a884e270881000.png" />
      <link rel="apple-touch-icon" sizes="192x192" href="https:&#x2F;&#x2F;jimluo.github.io&#x2F;processed_images&#x2F;67ecf87962747c1700.png" />
      <link rel="apple-touch-icon" sizes="256x256" href="https:&#x2F;&#x2F;jimluo.github.io&#x2F;processed_images&#x2F;73ad5705c9d7c81300.png" />
      <link rel="apple-touch-icon" sizes="384x384" href="https:&#x2F;&#x2F;jimluo.github.io&#x2F;processed_images&#x2F;1c22f6dd0a34f84400.png" />
      <link rel="apple-touch-icon" sizes="512x512" href="https:&#x2F;&#x2F;jimluo.github.io&#x2F;processed_images&#x2F;f9196920c2e9808000.png" />
      
    

    

    <meta property="og:type" content="website">

    <meta name="twitter:card" content="summary">

    

    

    
      
        <meta name="description" content="输出是最好的学习方式" />
        <meta name="twitter:description" content="输出是最好的学习方式">
      
    

    
      <meta name="twitter:title" content="终端资产的全面发现管理">
    

    
      <link rel="prerender" href="https:&#x2F;&#x2F;github.com&#x2F;jimluo" />
    

    <link rel="prefetch" href="https:&#x2F;&#x2F;jimluo.github.io&#x2F;processed_images&#x2F;2abb4f8ff69df78500.png" />

    <title>
      
        
          终端资产的全面发现管理
        
      
    </title>

    
    
      <link rel="stylesheet" href="https://jimluo.github.io/main.css">
    
    
  
    <link rel="prerender" href="https:&#x2F;&#x2F;jimluo.github.io&#x2F;net-token&#x2F;">
  

  
    <link rel="prerender" href="https:&#x2F;&#x2F;jimluo.github.io&#x2F;audit-upgrade&#x2F;">
  

  
    <link rel="prerender"  href="https://jimluo.github.io/tags/linux/">
  

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "NewsArticle",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://google.com/article"
      },
      "headline": "终端资产的全面发现管理",
      "image": [],
      "datePublished": "2022-04-13T00:00:00+00:00",
      "dateModified": "2022-04-13T00:00:00+00:00",
      "author": {
        "@type": "Person",
        "name": "罗进"
      },
       "publisher": {
        "@type": "Organization",
        "name": "罗进",
        "logo": {
          "@type": "ImageObject",
          "url": "https://jimluo.github.io/icon.png"
        }
        
      }
      
    }
  </script>

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        

        
        {
          
          "@type": "ListItem",
          "position": 1,
          "name": "",
          "item": "https://jimluo.github.io/"
        },
        
        {
          "@type": "ListItem",
          "position": 2,
          "name": "终端资产的全面发现管理",
          "item": "https://jimluo.github.io/asset-discovery/"
        }
      ]
    }
  </script>

  </head>
  <body>
    
      <header>
        <a class="profile-icon" href="/">
          <img src="https:&#x2F;&#x2F;jimluo.github.io&#x2F;processed_images&#x2F;2abb4f8ff69df78500.png" alt="profile picture">
        </a>
        <nav>
          
            <a href="https:&#x2F;&#x2F;github.com&#x2F;jimluo">Github</a>
          
        </nav>
      </header>
    
    <main>
    
  <div class="post-title">
    <h1>终端资产的全面发现管理</h1>
    <small>
      April 13, 2022
      
        - 
        <span class="tags">
          
            <a href="https://jimluo.github.io/tags/linux/">Linux</a>
          
        </span>
      
    </small>
  </div>

  <div>
    <p>终端资产的全面清理发现和管理是精细化管理也是安全办公生产的前提，</p>
<p>困难之处在于设备类型复杂(固定、移动、网络设备、摄像头、打印机等)，</p>
<p>人员角色多变赋予设备自身权限及可见度变化，</p>
<p>最后长时间使用，设备和人员的更替，再时间上追溯困难。</p>
<h3 id="wen-ti-zhong-dian-biao-xian-zai">问题重点表现在</h3>
<p>主流资产发现及管理系统，使用的技术，主动扫描和被动流量发现各自都有缺陷</p>
<ol>
<li>主动扫描发现不了未开机和休眠资产设备</li>
<li>被动流量分析发现不了数据未经过核心交换机的设备（因为被动流量分析的服务设备接在核心交换机上，见下图）</li>
<li>被动流量分析发现不了分析前接入的设备</li>
<li>设备资产间的在时间上的关系无法确定，也就不能评估出安全风险</li>
</ol>
<p>常用技术名词概念</p>
<ol>
<li>终端资产：用户单位的电脑。在安全业务上，用于对安全问题的物理定位，及时找到机器和操作人员</li>
<li>ARP地址解析协议：根据IP地址获取物理mac地址的协议</li>
<li>ARP表：交换机中IP与MAC地址对应关系缓存表</li>
<li>SNMP OIDS：交换机和路由器中缓存的设备信息表</li>
<li>NetFlow表：交换机和路由器中缓存的设备外联流量信息</li>
<li>DHCP服务：动态分配IP地址给刚入网的设备，保留了所有入网设备的信息。每台设备使用的IP过期后，再定期续租申请。</li>
<li>DNS服务：将域名解析为可以访问的IP，保留了终端设备的请求网络信息</li>
<li>网络设备：交换机和路由器。其存有ARP表、路由表、SNMP OIDS信息，NetFlow表</li>
<li>服务设备：DHCP服务和DNS服务等，其存有设备的网络和机器信息</li>
<li>终端设备：电脑的设备制造商、操作系厂商、常用软件和使用时间上的规律</li>
<li>主动扫描：轮询全网每一台终端，发起预制的网络请求，根据收到的响应判断终端的设备信息</li>
<li>被动流量分析：镜像连接在核心交换机上，根据网络所有设备的流量信息，分析访问关系和部分设备信息</li>
</ol>
<h3 id="quan-mian-fa-xian-guan-li-de-gong-zuo-liu-cheng">全面发现管理的工作流程</h3>
<h4 id="fa-xian">发现</h4>
<p>基于3种设备(网络设备、服务设备、终端设备)和2种行为(主动、被动)获取设备机器信息和网络连通信息。
尤其是发生的时间和外联关系。持续监控设备的连接断开，获取实时信息而不中断业务。</p>
<p>通过网络设备信息，整合主动与被动发现信息</p>
<p>通过服务信息，整合流量与设备信息</p>
<p>其特点是</p>
<ul>
<li>发现未开机和休眠资产设备</li>
<li>发现网络流量未经过核心交换机的设备</li>
<li>发现分析前接入的设备</li>
</ul>
<table><thead><tr><th>2种行为\3种设备</th><th>网络设备</th><th>服务设备</th><th>终端设备</th></tr></thead><tbody>
<tr><td>主动扫描和获取(范围大，信息多)</td><td>设备外联时间和位置</td><td>设备的网络和机器信息</td><td>运行在设备的代理(如杀毒软件）</td></tr>
<tr><td>获取全面的机器信息，可选择不使用，不影响用户业务</td><td>被动监控(实时性高)</td><td>全网流量信息</td><td>设备的连接和断开</td></tr>
</tbody></table>
<h4 id="fa-xian-yuan-li">发现原理：</h4>
<ol>
<li>主动获取网络设备和服务设备中存在的IP设备及流量信息，并整合两者信息，全时间段的信息</li>
<li>被动获取全网流量信息，当前时间段的信息</li>
<li>比较找出存在于主动信息#1中而不存在于被动信息#2中的设备</li>
<li>分析这些设备流量的发生时间</li>
<li>判断发生时间暂时的，只是最近没有出现，是未开机和休眠</li>
<li>判断发生时间是曾经有过，现在一直没有出现，是以前接入，现在可能已不存在</li>
</ol>
<h4 id="fen-lei">分类</h4>
<p>按照设备类型、操作系统、时间分类，并在时间上聚合不同设备间的网络访问关系，丰富上下文</p>
<h4 id="ping-gu">评估</h4>
<ul>
<li>识别安全风险，评估合规达标程度</li>
<li>最终获得对网络操作风险的态势感知，使用全面的上下文评估策略遵从性和设备安全姿态</li>
</ul>
<h3 id="zong-jie-qi-te-dian">总结其特点</h3>
<ol>
<li>更全面地发现资产
<ul>
<li>发现未开机和休眠资产设备</li>
<li>网络流量未经过核心交换机的设备</li>
<li>发现分析前接入的设备</li>
</ul>
</li>
<li>更易于分类，基于空间和时间的上下文</li>
<li>更准确地评估合规的达标度，识别安全风险</li>
<li>不中断不影响用户业务</li>
</ol>

  </div>

  <hr class="footer-rule" />

  

  <div class="related-container">

    
      <div class="link">
        Previous <br />
        <a href="https:&#x2F;&#x2F;jimluo.github.io&#x2F;net-token&#x2F;">基于Rust和BPF技术的网络TCP水印</a>
      </div>
    

    
      <div class="link">
        Next <br />
        <a href="https:&#x2F;&#x2F;jimluo.github.io&#x2F;audit-upgrade&#x2F;">CWPP中Audit的升级换代</a>
      </div>
    

  </div>


    </main>
    <footer class="footer-page">
    
      
        <p>© 2022, Jim Luo | simple-dev-blog theme on Zola</p>

      
    
    </footer>
  </body>
</html>
